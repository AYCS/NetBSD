VERSION: :1,$s/2014-08-23/2014-08-23/g
ISO:     :1,$s/201408192000Z/201408192000Z/g
PKGSRC:  :1,$s/2014-08-16/2014-08-16/
NetBSD:  :1,$s/7.99.1/7.99.1/g

To: port-armNetBSD.org@localhost
Subject: 2014-08-23-netbsd-raspi.img (Re: Raspberry Pi update please.)
From: Jun Ebihara <jun@soum.co.jp>

I've updated 2014-08-23-netbsd-raspi.img.gz for RPI.

ftp://ftp.netbsd.org/pub/NetBSD/misc/jun/raspberry-pi/2014-08-23-earmhf/2014-08-23-netbsd-raspi.img.gz

Update:
- NetBSD-current 7.99.1 evbarm-earmhf 201408192000Z from nyftp.
- pkgsrc-current 2014-08-16 tarball from ftp.NetBSD.
- openssl 1.0.1i
  http://mail-index.netbsd.org/source-changes/2014/08/10/msg057510.html
- net/mikutter : 3.0.4
  http://mail-index.netbsd.org/pkgsrc-changes/2014/08/10/msg109675.html
- x11/mlterm   : 3.3.8
  http://mail-index.netbsd.org/pkgsrc-changes/2014/08/16/msg109955.html
- ~/.dillo/cookiesrc : 
  DEFAULT ACCEPT_SESSION for twitter account activation.

- This is hardfloat image: build with earmhf
   softfloat: 2013-09-09-02-netbsd-evbarm.img.gz  evbarm (02:firmupdate) 
>> hardfloat: 2014-08-23-netbsd-raspi.img.gz      earmhf

Pre-compiled packages:
- Pre-compiled packages path setting: see /etc/pkg_install.conf 
PKG_PATH=ftp://ftp.netbsd.org/pub/NetBSD/misc/jun/raspberry-pi/earmhf/2014-08-23/
 To install application.
 # pkg_add some_application_name

 If you update pkgsrc by yourself,comment out /etc/pkg_install.conf and check
 /etc/mk.conf.

SHARP NetWalker kernel: (Thanx h_kenken@)
  /boot/netbsd-NETWALKER.bin.gz is a kernel for Sharp NetWalker.

  1. Make backup image on NetWalker ubuntu.
  2. cp /boot/netbsd-netwalker.bin.gz [BackupImage]/boot/zImage
  3. Set [BackupImage] MicroSD to NetWalker MicroSD port
  4. Set RPI image to USB port via SD to USB dongle.
  5. With pushing [L Mouse][R Mouse],push Power button in 5 seconds.
  6. Pray for success in 5 seconds.
  7. Typical NetBSD Boot message appears on your console.
  8. Fail on single user mode,"mount /"
  9. vi /etc/fstab and type :1,$s/ld0/sd0/g w q
  10. reboot and login again.
  11. startx and mouse can control with small touchpad.

musica - DLNA/UPnP music server: (Thanx @cvsync)
 MAEKAWA Masahide make a DLNA/UPnP music server called "musica".
 
  1. Check http://www.m-systems.co.jp/musica/index_en.html .
  2. Download musica-0.2.0-netbsd6-evbarm-earmhf.tgz for evaluation.
  3. pkg_add musica-0.2.0-netbsd6-evbarm-earmhf.tgz
  4. musica -d [AAC,MP3,WMA,FLAC,DSDIFF,DSF,AIFF,WAV,Apple Lossless dir]
  5. Find from DLNA/UPnP AV equipment.
  6. With a little luck,you'll find musica and enjoy music via musica.
  7. If you feel slow,Try {NetBSD/amd64 i386,OSX,Ubuntu} Version or improve NetBSD.

XM6i - SHARP X68030 Emulator for NetBSD/x68k (Thanx isaki@)
  Need more testing: http://t.co/dpOaxtHZRe . wxGTK28 package required.

KOBO: kernel: (Thanx h_kenken@)
  kobo-kernels and uboot on /boot:
    mmcinfo 1
    fatload mmc 1 0x70800000 kobo.bin
    go 0x70800000

Todo:
- Summarize /usr/tests result on each version.
- test COPTS:-fno-reorder-blocks/-fno-tree-vrp/-fno-tree-pre optimization.
- ruby version: 200 -> 21?
- Need GPIO & bus controll document and implimentation (via lua?)
- comment out kernel DEBUG/DIAGNOSTIC option
- DTRACE http://wiki.netbsd.org/tutorials/how_to_enable_and_run_dtrace/
- yaft (yet another framebuffer terminal):
  https://github.com/uobikiemukot/yaft
- wip/ruby-therubyracer to support RoR,such as https://github.com/shirasagi/.
- RPI.rst in english.

=====================

For OpenSourceConference 2014 Shimane NetBSD booth
(https://www.facebook.com/events/1475184532697066/)
demonstration use, I've updated raspberry-pi image.

- NetBSD 7.99.1 earmhf rpi.img.gz base
- Connect HDMI,USB Keyboard,USB Mouse,Ether(dhcpd and ntpd will work)
- login root (no passwd)
- startx ,and icewm running.
- running mikutter.
  twitter client (net/mikutter) on 40inch home TV.
  http://movapic.com/ebijun/pic/5168479

  # startx
  # mikutter &
  or
  # LANG=en_US.UTF-8 mikutter &
       English menu support. LANG environment setting on .xinitrc .

  ==== one or two or threee moment =====

Appear mikutter window. and mikutter-chan tell you,

"Well done on the installation!" [Next]
"Hi! This is mikutter-chan speaking to you,join the twitter with me!" [Next]
 1. "Click the link https:......" click the URL, 
    and start dillo browser automaticaly. 
 2. "login with the Twitter account you wish to use."
 3. "Go along until you see a 7-digit code and type it in at the top."
  -> get pin number.
  -> paste pin number to mikutter
 4. "Congratulations! You have attained achievement register_account!"

  Share your twitter timeline with your family!

Features:
  - fit size for 2GB SD Card
  - with X11
  - increase more inodes on /dev/ld0a
  - Recent current RPI kernel
  - USB/video support: as -current (video needs more tests)
  - pkgsrc: 2014-08-16 tree inside.
  - pre-build packages
    ftp://ftp.netbsd.org/pub/NetBSD/misc/jun/raspberry-pi/earmhf/2014-08-23/

Installed Packages:
kterm
tcsh
vlgothic-ttf
icewm
xli
mikutter
medit
uim
fossil
raspberrypi-userland
sudo
git-base
zsh
dillo
mlterm
pkg_chk
lintpkgsrc
mozilla-rootcerts

To control HDMI output,add/delete "console=fb" on cmdline.txt.
If delete console=fb definition,you can get serial console instead.
 rpi$ more /boot/cmdline.txt
 root=ld0a console=fb

Keyboard layout checkpoint:
/etc/wscons.conf
 #encoding sv
 #encoding us.swapctrlcaps
 encoding jp

/root/.xinitrc
 setxkbmap -model jp106 jp

Build sample script:
 https://github.com/ebijun/NetBSD/tree/master/RPI/RPIimage/Image

Guide:
 https://github.com/ebijun/NetBSD/blob/master/Guide/RPI.rst

BUGS:
1. dillo crashes at startup
  http://lists.dillo.org/pipermail/dillo-dev/2014-May/010161.html
  This image contains dillo with patch by Michael van Elst.
  http://mail-index.netbsd.org/port-arm/2014/04/22/msg002386.html
2. port-arm/48805
  Audio Driver issues on Pi running NetBSD (2014-05-10) image 
  - hangs audio applications like audioplay
3. medit dumping core when write text.
4. port-arm/48855
  i2cscan on RPi NetBSD build finds device for all addresses
5. i2c problem reported from "its sead".
  /usr/sbin/i2scan on iic0 or iic1 often crashes the device (also with the -r 
  (use writes) option)
6. cap_mkdb failed, on update terminfo db.
  https://twitter.com/uobikiemukot/status/487977340949893121

One more time: (we're gonna celebrate

 1. login root
 2. mlterm-fb 
 3. ftp http://mlterm.sf.net/vimperator.six
 4. cat vimperator.six
 5. exit 
 6. mlterm-fb --rotate=left
 7. cat vimperator.six

--
Jun Ebihara
