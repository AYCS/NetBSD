VERSION: :1,$s/2014-03-22/2014-03-22/g
ISO:     :1,$s/201403161940Z/201403161940Z/g
PKGSRC:  :1,$s/2014-03-15/2014-03-15/g
NetBSD:  :1,$s/6.99.36/6.99.36/g

To: port-armNetBSD.org@localhost
Subject: 2014-03-22-netbsd-raspi.img (Re: Raspberry Pi update please.)
From: Jun Ebihara <jun@soum.co.jp>

I've updated 2014-03-22-netbsd-raspi.img.gz for RPI.

ftp://ftp.netbsd.org/pub/NetBSD/misc/jun/raspberry-pi/2014-03-22-earmhf/2014-03-22-netbsd-raspi.img.gz

Update:
- NetBSD-current 6.99.36 evbarm-earmhf 201403161940Z from nyftp
- pkgsrc-current         2014-03-15 tarball from ftp.NetBSD
- This is hardfloat image: build with earmhf
   softfloat: 2013-09-09-02-netbsd-evbarm.img.gz  evbarm (02:firmupdate) 
>> hardfloat: 2014-03-22-netbsd-raspi.img.gz      earmhf

[NEW] Pre-compiled packages:
- Pre-compiled packages path setting: see /etc/pkg_install.conf 
PKG_PATH=ftp://ftp.netbsd.org/pub/NetBSD/misc/jun/raspberry-pi/earmhf/2014-03-22/
 To install application.
 # pkg_add some_application_name

- Web Browser on pre-compiled packages
   http://movapic.com/ebijun/pic/5113907
  deforaos-surfer
  dillo
  epiphany
  midori
- deforaos packages : (Thanx khorben@ in AsiaBSDCon2014 !)
  deforaos-browser
  deforaos-camera
  deforaos-coder
  deforaos-editor
  deforaos-keyboard
  deforaos-locker
  deforaos-mailer
  deforaos-mixer
  deforaos-panel
  deforaos-pdfviewer
  deforaos-phone
  deforaos-player
  deforaos-surfer

[NEW] Sharp NetWalker special kernel (Thanx h_kenken@ in AsiaBSDCon2014!)
  /boot/netbsd.netwalker.touchpad.zImage is a special kernel by h_kenken.

  1. Make backup image on NetWalker ubuntu.
  2. cp /boot/netbsd.netwalker.touchpad.zImage [BackupImage]/boot/zImage
  3. Fix this RPI image:/etc/fstab :1,$s/ld0/sd0/g
  4. Set [BackupImage] MicroSD to NetWalker MicroSD port
  5. Set RPI image to USB port via SD to USB dongle.
  6. With pushing [L Mouse][R Mouse],push Power button in 5 seconds.
  7. Pray for success in 5 seconds.
  8. Typical NetBSD Boot message appears on your console.
  9. startx and mouse can control with small touchpad.

Todo:
- Need GPIO & bus controll document and implimentation (via lua?)
- comment out kernel DEBUG/DIAGNOSTIC option
- DTRACE http://wiki.netbsd.org/tutorials/how_to_enable_and_run_dtrace/

=====================

For OpenSourceConference 2014 Hamanako NetBSD booth
 (https://www.facebook.com/events/219229504913284/)
demonstration use, I've updated raspberry-pi image.

- NetBSD 6.99.36 earmhf rpi.img.gz base
- Connect HDMI,USB Keyboard,USB Mouse,Ether(dhcpd and ntpd will work)
- login root (no passwd)
- startx ,and icewm running.
  twitter client (net/mikutter) on 40inch home TV.
  http://movapic.com/pic/2013061822184751c05e37e612e
- running mikutter.
  # startx
  # dillo &
  # mikutter &
  copy twitter auth URL and paste into dillo URL bar.
  -> get pin number.
  -> paste pin number to mikutter
  ==== one or two or threee moment =====
  Get your twitter timeline with your family!

Features:
  - fit size for 2GB SD Card
  - with X11
  - increase more inodes on /dev/ld0a
  - Recent current RPI kernel
  - USB/video support: as -current (video needs more tests)
  - pkgsrc: 2014-03-15 tree inside.
  - pre-build packages
   ftp://ftp.netbsd.org/pub/NetBSD/misc/jun/raspberry-pi/2014-03-22-earmhf/packages

Installed Packages:
kterm
tcsh
vlgothic-ttf
icewm
xli
mikutter
medit
uim
fossil
raspberrypi-userland
sudo
git-base
zsh
dillo
mlterm
pkg_chk
lintpkgsrc

To control HDMI output,add/delete "console=fb" on cmdline.txt.
If delete console=fb definition,you can get serial console instead.
 rpi$ more /boot/cmdline.txt
 root=ld0a console=fb

Keyboard layout checkpoint:
/etc/wscons.conf
 #encoding sv
 #encoding us.swapctrlcaps
 encoding jp

/root/.xinitrc
 setxkbmap -model jp106 jp

Build sample script:
 https://github.com/ebijun/NetBSD/tree/master/RPI/RPIimage/Image

Guide:
 https://github.com/ebijun/NetBSD/blob/master/Guide/RPI.rst

Need Fix:
1. Cannot input Japanese special keys of JP106 keyboard with NetBSD/evbarm(RPI) or some arch. (sample binary replaced in this image)
 xsrc/48347: still open,anybody cares? 
 http://gnats.netbsd.org/cgi-bin/query-pr-single.pl?number=48347

patch: xsrc/external/mit/xf86-input-keyboard/dist/src/bsd_KbdMap.c
 http://www.yagoto-urayama.jp/~oshimaya/netbsd/files/xf86-input-keyboard_N6.diff

 bluetooth keyboard: add configration
  include "dev/bluetooth/bluetoothdevices.config"

One more time: (we're gonna celebrate

 1. login root
 2. start mlterm-fb 
   # mlterm-fb
 3. ftp http://mlterm.sf.net/vimperator.six
 4. cat vimperator.six

--
Jun Ebihara
